<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">

  <title> the latency between a key being pressed - Gmagon Software - handy and professional Mac apps.</title>

  <meta http-equiv="X-UA-Compatible" content="IE=8; IE=9; IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="robots" content="noodp" />
  <meta name="keywords" content=" the latency between a key being pressed" />
  <meta name="description" content=" the latency between a key being pressed" />

  <!-- Custom config og:image -->


  <!-- Open Graph -->
<meta name="description" content="the latency between a key being pressed - Gmagon Software - handy and professional Mac apps.">
<meta property="og:type" content="apps">
<meta property="og:title" content=" the latency between a key being pressed - Gmagon Software - handy and professional Mac apps.">
<meta property="og:url" content="https://gmagon.com/blog/2017/08/21/The-latency-between-a-key-being-pressed/index.html">
<meta property="og:site_name" content=" the latency between a key being pressed - Gmagon Software - handy and professional Mac apps.">
<meta property="og:description" content="the latency between a key being pressed - Gmagon Software - handy and professional Mac apps.">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://img0.tuicool.com/YbaEzan.png!web">
<meta property="og:updated_time" content="2017-08-21T03:34:51.475Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" the latency between a key being pressed - Gmagon Software - handy and professional Mac apps.">
<meta name="twitter:description" content="the latency between a key being pressed - Gmagon Software - handy and professional Mac apps.">
<meta name="twitter:image" content="http://img0.tuicool.com/YbaEzan.png!web">
<meta name="twitter:site" content="gmagonshare">
<meta property="fb:admins" content="432634277117208">
<meat name="twitter:url" content="https://gmagon.com/blog/2017/08/21/The-latency-between-a-key-being-pressed/index.html">



  <!-- algolia_config -->
  
  
  <!-- Canonical links -->
  <link rel="canonical" href="https://gmagon.com/blog/2017/08/21/The-latency-between-a-key-being-pressed/index.html">

  <!-- Alternative links -->
  

  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">

  <!-- CSS -->
  <link rel="stylesheet" href="/build/css/navy-6ac2b4c9e5.css">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  
  <!-- jQuery -->
  <script src="/js/jquery/jquery-3.2.1.min.js"></script>
<script src="/js/jquery/jquery-migrate-1.4.1.min.js"></script>



  <!-- ForPostLayout -->
  
    
    
  
  <!-- endForPostLayout -->

  <!-- RSS -->
  <link rel="alternate" href="/atom.xml" title="Gmagon Software - handy and professional Mac apps.">

  <!-- algolia_search -->
  <script src="/assets/algolia/algoliasearchLite.min.js" async></script>

  <!-- Github Button -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  <!-- Utils -->
<script src="/js/utils.js"></script>
</head>

<body>
  <div id="container">
    <header id="header">
  <div class="wrapper">
    <div id="header-inner" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Gmagon Software - handy and professional Mac apps.</a>
        <span>gmagon </span>
      </h1>
      <nav id="main-nav">
        <a href="/" class="main-nav-link ">Home</a><a href="/products/" class="main-nav-link ">Products</a><a href="/guide/" class="main-nav-link ">Guide</a><a href="/support/" class="main-nav-link ">Support</a><a href="/blog/" class="main-nav-link ">Blog</a>
        <div id="search-input-wrap">
          <a href="/search/" class="text-decoration-none">
            <div id="search-input-icon">
              <i class="fa fa-search"></i>
            </div>
          </a>
        </div>
      </nav>
      <div id="lang-select-wrap">
        <label id="lang-select-label"><i class="fa fa-globe"></i><span>English</span></label>
        <select id="lang-select" data-canonical="">
          
            <option value="en" selected>English</option>
          
        </select>
      </div>
      <a id="mobile-nav-toggle">
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
        <span class="mobile-nav-toggle-bar"></span>
      </a>
    </div>
  </div>  
</header>
<div class="hide-wrap-head-top"></div>

    <div class="class-content-wrap">
  <div class="inner">
    <div class="inner-wrap fill-bunting font-e3">
      <h2 id="banner-title">  the latency between a key being pressed </h2>
      <div id="banner-start">
        <a class="btn btn-static-secondary btn-shadow" href="https://gitter.im/Gmagon/support" ttarget="_blank" rel="nofollow me noopener noreferrer" >Need help?</a>
      </div>
    </div>
  </div>
</div>

<div class="class-content-wrap">
  <div class="wrapper">
    <div class="inner">
      <article class="article-container" itemscope itemtype="http://schema.org/Article">
        <div class="article-inner">
          <div class="article">
          <div class="hide-wrap-head-top"></div>
<article class="article post" itemscope itemtype="http://schema.org/Article">
  <header class="article-header">
    
      <h1 class="article-title" itemprop="name"> the latency between a key being pressed</h1>
    
    <a href="/blog/2017/08/21/The-latency-between-a-key-being-pressed/" class="article-date"><time datetime="2017-08-21T00:00:00.000Z">2017-08-21</time></a>
  </header>
  <div class="article-content" itemprop="articleBody">
    <p>A month ago, danluu wrote about<a href="https://danluu.com/term-latency/">terminal and shell performance</a>. In that post, he measured the latency between a key being pressed and the corresponding character appearing in the terminal. Across terminals, median latencies ranged between 5 and 45 milliseconds, with the 99.9th percentile going as high as 110 ms for some terminals. Now I can see that more than 100 milliseconds is going to be noticeable, but I was certainly left wondering: Can I really perceive a difference between 5 ms latency and 45 ms latency?</p>
<p>Turns out that I can.</p>
<h2 id="Where-I-came-from"><a href="#Where-I-came-from" class="headerlink" title="Where I came from"></a>Where I came from</h2><p>Like probably all shell configurations, mine has a prompt, that is: It displays some contextual data when I can enter the next command. Most prompts include the username, hostname, and the current working directory. Mine can also include the current Git branch and commit, the current kubectl context, and which OpenStack credentials are currently loaded. It knows some quite unique tricks. For example, if the current working directory is not accessible anymore, it highlights the inaccessible path elements. Or, inside a Git repository, it highlights the path elements inside the repo.</p>
<p><img src="http://img0.tuicool.com/YbaEzan.png!web" alt=""></p>
<p>Since that’s quite a lot of logic, I delegated the rendering of the entire prompt to a custom program. That program used to be a<a href="https://github.com/majewsky/devenv/blob/643a55f49b13401e6333fbb3a1413cd7dc59907f/bin/prettyprompt.py">Python 2 script</a>, but since I’m not nearly as fluent in Python as I used to be, I didn’t dare touch it anymore. I therefore decided to rewrite it into a<a href="https://github.com/majewsky/gofu">Go program</a>. The feature set didn’t change, but here’s a thing that_did_change:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ time .</div><div class="line">/bin/</div><div class="line">prettyprompt.py </div><div class="line">&gt;</div><div class="line">/dev/</div><div class="line">null</div><div class="line">; time prettyprompt </div><div class="line">&gt;</div><div class="line">/dev/</div><div class="line">null</div><div class="line"></div><div class="line">.</div><div class="line">/bin/</div><div class="line">prettyprompt.py </div><div class="line">&gt;</div><div class="line">/dev/</div><div class="line">null</div><div class="line">0</div><div class="line">,</div><div class="line">05</div><div class="line">s user </div><div class="line">0</div><div class="line">,</div><div class="line">00</div><div class="line">s system </div><div class="line">98</div><div class="line">% cpu </div><div class="line">0</div><div class="line">,</div><div class="line">057</div><div class="line"> total</div><div class="line">prettyprompt </div><div class="line">&gt;</div><div class="line">/dev/</div><div class="line">null</div><div class="line">0</div><div class="line">,</div><div class="line">00</div><div class="line">s user </div><div class="line">0</div><div class="line">,</div><div class="line">00</div><div class="line">s system </div><div class="line">92</div><div class="line">% cpu </div><div class="line">0</div><div class="line">,</div><div class="line">003</div><div class="line"> total</div></pre></td></tr></table></figure>
<p>The new prompt renders in 3 ms whereas the old one took 57 ms. That’s nothing to do with sloppy programming, that’s just how long it takes to start up the Python interpreter, as can be easily observed by running a Python interpreter without actually doing anything:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ time python2 -c </div><div class="line">0</div><div class="line">&gt;</div><div class="line">/dev/</div><div class="line">null</div><div class="line"></div><div class="line">python2 -c </div><div class="line">0</div><div class="line">&gt;</div><div class="line">/dev/</div><div class="line">null</div><div class="line">0</div><div class="line">,</div><div class="line">02</div><div class="line">s user </div><div class="line">0</div><div class="line">,</div><div class="line">01</div><div class="line">s system </div><div class="line">52</div><div class="line">% cpu </div><div class="line">0</div><div class="line">,</div><div class="line">050</div><div class="line"> total</div></pre></td></tr></table></figure>
<p>(By the way, all these measurements are on hot caches. The first execution of<code>python2</code>takes more than double as long.)</p>
<p>The Go program, on the other hand, does not need to start a runtime. It’s probably short-lived enough to never even garbage-collect.</p>
<h2 id="The-“Wow-effect”…-I-guess"><a href="#The-“Wow-effect”…-I-guess" class="headerlink" title="The “Wow effect”… I guess?"></a>The “Wow effect”… I guess?</h2><p>I did these measurements while I was still writing the Go program, just for fun. But only after switching to the new prompt did I realize how much snappier my terminal feels just because of this change. There was always this short gap between seeing the output of one command and being able to enter the next command, but I did never really understand that this was due to my slow prompt renderer, and not due to the behavior of the shell, the terminal, the OS scheduler, or any other entity involved in the process.</p>
<p>When I press Enter in my shell now, the next prompt just appears instantaneously, without any perceivable latency between the keypress and the prompt being rendered. This feels so magical, I cannot even put it into words. It’s as if this were a new notebook, not the same one that I’ve been using for five years now.</p>
<p>The point is, latency really_is_important for how an application or a system feels. I will definitely care more about responsiveness of my programs in the future after this experience.</p>
<p>Created: Sun, 20 Aug 2017 19:02:45 UTC</p>
<p>Last edited:<a href="https://github.com/majewsky/blog-data/commits/master/posts/latency-matters.md">Sun, 20 Aug 2017 19:10:28 UTC</a></p>
<p>Source: <a href="http://www.tuicool.com/articles/hit/UFvMzmv">https://blog.bethselamin.de/posts/latency-matters.html</a></p>

  </div>
  

 <!-- jsSocials -->
<script src="/jssocials-1.4.0/jssocials.min.js"></script>
<link rel="stylesheet" href="/jssocials-1.4.0/jssocials.css">
<link rel="stylesheet" href="/jssocials-1.4.0/jssocials-theme-flat.css">

<div class="socials-share-btn"></div>
<script>
  if ($) {
    $(document).ready(function(){
      $(".socials-share-btn").jsSocials({
        shares: ["email", "twitter", "facebook", "googleplus", "linkedin", "pinterest", "stumbleupon", "whatsapp"]
      });
    })
  }
</script>


  
<section id="comments">
  <div id="disqus_thread"></div>
</section>
<script>
  var disqus_shortname = 'gmagon';
  var disqus_url = 'https://gmagon.com/blog/2017/08/21/The-latency-between-a-key-being-pressed/index.html';
  var disqus_title = " the latency between a key being pressed";
  var disqus_config = function(){
    this.language = 'en';
  };
  (function(){
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

  <script src="/js/audios.js"></script>
</article>

          </div>
      
          <aside id="article-toc" role="navigation">
                <div id="article-toc-inner">
                  <strong class="sidebar-title">Contents</strong>
                  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Where-I-came-from"><span class="toc-text">Where I came from</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-“Wow-effect”…-I-guess"><span class="toc-text">The “Wow effect”… I guess?</span></a></li></ol>
                  <a href="#" id="article-toc-top">Back to Top</a>
                </div>
          </aside>
        </div>
      </article>
    </div>
  </div>
</div>

<div class="class-content-wrap">
  <div class="inner">
    <div class="inner-wrap landing-bunting">
      <div class="intro-sub-content-wrap">
      </div>
    </div>
  </div>
</div>



    <footer id="footer" class="landing-bunting font-e3">
  <div class="inner">
    <div id="footer-some-docs">
        <a href="/terms_conditions.html" class="footer-doc-link" >Terms & Conditions</a>
        <a href="/privacy.html" class="footer-doc-link" >Privacy</a>
        <a href="/end-user-license-agreement.html" class="footer-doc-link" >License Agreement</a>
    </div>
    <div id="footer-copyright">
       <a href="" > Copyright &copy; 2017 Gmagon,Inc. All rights reserved. </a>
    </div>
    <div id="footer-links">
      
      <a href="https://twitter.com/gmagonshare" class="footer-link" target="_blank" rel="nofollow me noopener noreferrer" ><i class="fa fa-twitter"></i></a>
      
      <a href="https://www.facebook.com/gmagonshare" class="footer-link" target="_blank" rel="nofollow me noopener noreferrer" ><i class="fa fa-facebook"></i></a>
      <a href="https://www.youtube.com/gmagonshare" class="footer-link" target="_blank" rel="nofollow me noopener noreferrer" ><i class="fa fa-youtube"></i></a>
      <a href="https://www.instagram.com/gmagonshare" class="footer-link" target="_blank" rel="nofollow me noopener noreferrer" ><i class="fa fa-instagram"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/" class="mobile-nav-link ">Home</a><a href="/products/" class="mobile-nav-link ">Products</a><a href="/guide/" class="mobile-nav-link ">Guide</a><a href="/support/" class="mobile-nav-link ">Support</a><a href="/blog/" class="mobile-nav-link ">Blog</a>
      
    </ul>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>English</span></span>
    <select id="mobile-lang-select" data-canonical="">
      
        <option value="en" selected>English</option>
      
    </select>
  </div>
</nav>

  <!-- Scripts -->
<script src="/build/js/main-8277743eaa.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/retinajs/1.3.0/retina.min.js" async></script> -->

<!-- totop -->
<div id="gmagon_totop" style="position:fixed;bottom:150px;right:30px;cursor: pointer;">
  <a title="Back to top"><img src="/asset/images/scroll-up.png"/></a>
</div>
<script src="/js/totop.js"></script>





<!-- Google Analytics -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-99314951-1', 'auto');
  ga('send', 'pageview');
</script>


</body>
</html>